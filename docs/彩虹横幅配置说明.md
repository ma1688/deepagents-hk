# 🌈 彩虹横幅配置说明

## 功能介绍

HKEX Agent 的 ASCII 横幅现在支持**彩虹渐变效果**，每一行都会以不同的颜色显示，呈现出动态跑马灯般的视觉效果。

### 效果预览

```
🔴 红色  ___  ____ __ _______  __
🟠 橙色 / / / / //_// ____/ |/ /
🟡 黄色/ /_/ / ,<  / __/  |   /
🟢 绿色/ __  / /| |/ /___ /   |
🔵 青色/_/ /_/_/ |_/_____//_/|_|
🔵 蓝色  
🟣 紫色  (循环渐变)
```

---

## 配置方法

### 方式1：环境变量配置 (推荐)

在 `.env` 文件中添加：

```bash
# 启用彩虹效果 (默认启用)
HKEX_RAINBOW=true

# 禁用彩虹效果（使用单色）
# HKEX_RAINBOW=false

# 可选：自定义ASCII字体
HKEX_ASCII_FONT=slant  # 默认，推荐
```

### 方式2：修改代码

编辑 `src/cli/config.py`：

```python
# 直接修改默认值
HKEX_AGENT_ASCII = get_hkex_banner(rainbow=False)  # 禁用彩虹
```

---

## 自定义颜色

### 修改彩虹颜色方案

编辑 `src/cli/config.py` 中的 `RAINBOW_COLORS` 列表：

```python
# 默认彩虹色
RAINBOW_COLORS = [
    "#ff0000",  # 红
    "#ff7f00",  # 橙
    "#ffff00",  # 黄
    "#00ff00",  # 绿
    "#00ffff",  # 青
    "#0000ff",  # 蓝
    "#8b00ff",  # 紫
]

# 示例：金融主题（绿-黄-绿渐变）
RAINBOW_COLORS = [
    "#00ff00",  # 亮绿
    "#6bcf7f",  # 中绿
    "#ffd93d",  # 金黄
    "#ffb82e",  # 橙黄
    "#6bcf7f",  # 中绿
    "#00ff00",  # 亮绿
]

# 示例：冷色调（蓝-紫渐变）
RAINBOW_COLORS = [
    "#00d4ff",  # 青色
    "#0099ff",  # 蓝色
    "#0066ff",  # 深蓝
    "#6600ff",  # 靛蓝
    "#9900ff",  # 紫色
    "#cc00ff",  # 洋红
]

# 示例：暖色调（红-橙渐变）
RAINBOW_COLORS = [
    "#ff0000",  # 红色
    "#ff3300",  # 橙红
    "#ff6600",  # 深橙
    "#ff9900",  # 橙色
    "#ffcc00",  # 金黄
]

# 示例：简约黑白
RAINBOW_COLORS = [
    "#ffffff",  # 白色
    "#cccccc",  # 浅灰
    "#999999",  # 中灰
    "#666666",  # 深灰
]
```

---

## 技术实现

### 核心代码

```python
def get_hkex_banner(font: str = "slant", rainbow: bool = True) -> Union[Text, str]:
    """动态生成HKEX Agent横幅，支持彩虹渐变效果."""
    rainbow = os.getenv("HKEX_RAINBOW", str(rainbow)).lower() in ("true", "1", "yes")
    
    if rainbow:
        # 创建Rich Text对象
        text = Text()
        lines = banner_text.split("\n")
        
        # 为每行分配不同颜色
        for i, line in enumerate(lines):
            color_idx = i % len(RAINBOW_COLORS)
            text.append(line + "\n", style=f"bold {RAINBOW_COLORS[color_idx]}")
        
        return text
    else:
        return banner_text  # 普通字符串
```

### 打印逻辑

```python
# 自动检测类型并打印
from rich.text import Text

if isinstance(HKEX_AGENT_ASCII, Text):
    console.print(HKEX_AGENT_ASCII)  # 彩虹模式：Rich Text对象
else:
    console.print(HKEX_AGENT_ASCII, style=f"bold {COLORS['primary']}")  # 单色模式
```

---

## 使用场景

### 1. **演示模式**
```bash
# 启用彩虹效果，吸引眼球
export HKEX_RAINBOW=true
hkex
```

### 2. **专业模式**
```bash
# 禁用彩虹，简洁专业
export HKEX_RAINBOW=false
hkex
```

### 3. **主题定制**
根据不同场合，修改 `RAINBOW_COLORS` 为特定主题色：
- **财经主题**：绿色+金黄
- **科技主题**：青色+蓝色
- **企业主题**：品牌色渐变

---

## 性能说明

- **无性能影响**：Rich Text对象在初始化时生成一次，后续无开销
- **兼容性**：Rich库自动处理终端兼容性，不支持彩色的终端会自动降级
- **内存占用**：每个Rich Text对象约 1-2KB，可忽略

---

## 常见问题

### 1. 终端不显示彩色？

**原因**：终端不支持24位真彩色

**解决**：
```bash
# 检查终端类型
echo $TERM  # 应该是 xterm-256color 或 screen-256color

# 如果不是，设置环境变量
export TERM=xterm-256color
```

### 2. 彩色显示异常？

**排查**：
1. 确认 `.env` 中 `HKEX_RAINBOW=true`
2. 确认 Rich 库版本 >= 13.0.0
3. 重新启动 `hkex` 命令

### 3. 想要更多颜色？

**方法**：
- 在 `RAINBOW_COLORS` 列表中添加更多颜色
- 颜色会循环使用，行数多时会重复

---

## 技术依赖

| 库 | 版本 | 用途 |
|---|---|---|
| **Rich** | >= 13.0.0 | 彩色终端输出 |
| **pyfiglet** | >= 1.0.4 | ASCII艺术字生成 |

---

## 附录：颜色代码参考

### 常用颜色十六进制代码

| 颜色 | 代码 | RGB |
|------|------|-----|
| 红色 | `#ff0000` | (255, 0, 0) |
| 橙色 | `#ff7f00` | (255, 127, 0) |
| 黄色 | `#ffff00` | (255, 255, 0) |
| 绿色 | `#00ff00` | (0, 255, 0) |
| 青色 | `#00ffff` | (0, 255, 255) |
| 蓝色 | `#0000ff` | (0, 0, 255) |
| 紫色 | `#8b00ff` | (139, 0, 255) |
| 粉色 | `#ff00ff` | (255, 0, 255) |
| 白色 | `#ffffff` | (255, 255, 255) |
| 黑色 | `#000000` | (0, 0, 0) |

### Rich内置颜色名

也可以使用Rich的内置颜色名：
```python
RAINBOW_COLORS = ["red", "yellow", "green", "cyan", "blue", "magenta"]
```

---

## 相关文档

- [pyfiglet字体库](http://www.figlet.org/examples.html)
- [Rich库颜色文档](https://rich.readthedocs.io/en/stable/style.html)
- [ASCII艺术字生成说明](./ASCII艺术字生成说明.md)

